@role(server)
function signInWithSocialProvider(provider: "Github" | "Facebook" | "Passkey" | "Google", providerAccountId: String): { access: Token, refresh: Token } {

  let user = Account.firstWhere(
    .providerAccountId == providerAccountId && .provider == provider
  )?.user
  
  if(user != null) {
    createAccessAndRefreshToken(user!)
  } else {
    abort({
      code: "account_not_found",
      message: "No account or user found."
    })
  }
}