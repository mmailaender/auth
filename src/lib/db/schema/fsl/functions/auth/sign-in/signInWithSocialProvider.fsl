@role(server)
function signInWithSocialProvider(providerName: "Github" | "Facebook" | "Google", providerUserId: String): { access: Token, refresh: Token } {

  let user = Account.firstWhere(
    .socialProvider?.userId == providerUserId && .socialProvider?.name == providerName
  )?.user
  
  if(user != null) {
    createAccessAndRefreshToken(user!)
  } else {
    abort({
      code: "account_not_found",
      message: "No account or user found."
    })
  }
}